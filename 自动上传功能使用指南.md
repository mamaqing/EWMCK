# 自动上传功能使用指南

## 功能说明
本功能实现了修改分数后点击"生成二维码"按钮，系统自动将新分数报告生成图片并立即上传到GitHub，确保扫码能查看最新分数报告。

## 使用步骤

### 1. 启动上传服务器
在项目根目录下打开终端，执行以下命令启动上传服务器：

```bash
npm run start-upload-server
```

服务器启动成功后，会显示以下信息：
```
🚀 上传服务器已启动，监听端口 3001
📡 API地址: http://localhost:3001/upload-report
```

### 2. 启动开发服务器
在另一个终端窗口中执行以下命令启动开发服务器：

```bash
npm run dev
```

### 3. 修改分数
在浏览器中打开应用，根据需要修改各种认知能力分数。

### 4. 生成并上传二维码
点击"生成二维码"按钮，系统会自动完成以下操作：
- 生成报告图片
- 优化图片质量和大小（scale: 2, quality: 0.7）
- 将图片上传到GitHub
- 显示二维码

### 5. 扫码查看最新报告
上传成功后，扫描二维码即可查看最新的分数报告。

## 注意事项

1. **GitHub Pages更新延迟**：由于GitHub Pages的缓存机制，上传后可能需要1-5分钟才能在扫码时看到最新的报告。

2. **网络连接**：确保您的计算机已连接到互联网，并且可以访问GitHub。

3. **上传服务器状态**：请确保上传服务器始终处于运行状态，否则点击"生成二维码"按钮时会提示上传失败。

4. **权限问题**：确保当前用户对项目目录有读写权限，并且Git已正确配置。

## 故障排除

### 上传失败
如果点击"生成二维码"按钮后提示上传失败，请检查以下几点：

1. 上传服务器是否正在运行
2. 网络连接是否正常
3. Git配置是否正确
4. 查看上传服务器的日志，获取详细错误信息

### 扫码显示旧报告
如果扫码后显示的是旧报告，请等待1-5分钟后再次扫描，或手动刷新GitHub Pages缓存。

### 服务器启动失败
如果上传服务器启动失败，请检查以下几点：

1. 是否已安装依赖：执行`npm install express cors`
2. 是否有端口冲突：3001端口是否被其他程序占用
3. 查看终端输出的错误信息

## 手动上传选项

如果自动上传功能出现问题，您可以使用手动上传选项：

1. 点击"生成并保存报告图片"按钮，将报告图片保存到本地
2. 执行以下命令将图片上传到GitHub：

```bash
npm run generate-and-upload
```

3. 上传成功后，点击"生成二维码"按钮显示二维码

## 技术说明

- 上传服务器使用Express框架搭建，监听3001端口
- 图片质量已优化（scale: 2, quality: 0.7），平衡了质量和文件大小
- 上传过程包括：保存临时文件、复制到docs目录、Git提交和推送
- GitHub图片URL：https://mamaqing.github.io/EWMCK/报告图片/认知评估报告.png

如有任何问题，请参考项目文档或联系技术支持。